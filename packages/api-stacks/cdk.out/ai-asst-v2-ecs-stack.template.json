{
 "Resources": {
  "aiasstv2cluster6A2E082B": {
   "Type": "AWS::ECS::Cluster",
   "Properties": {
    "ClusterName": "ai-asst-v2-cluster",
    "Tags": [
     {
      "Key": "BudgetId",
      "Value": "001297-03"
     },
     {
      "Key": "Env",
      "Value": "dev"
     },
     {
      "Key": "LegalOU",
      "Value": "USA"
     },
     {
      "Key": "OrgOU",
      "Value": "GD"
     },
     {
      "Key": "Team",
      "Value": "commerceut"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "ai-asst-v2-ecs-stack/ai-asst-v2-cluster/Resource"
   }
  },
  "aiasstv2executionpolicy7F2E6E3C": {
   "Type": "AWS::IAM::Policy",
   "Properties": {
    "PolicyDocument": {
     "Statement": [
      {
       "Action": [
        "ecr:GetAuthorizationToken",
        "ecr:BatchGetImage",
        "ecr:GetDownloadUrlForLayer"
       ],
       "Effect": "Allow",
       "Resource": "*"
      },
      {
       "Action": "logs:*",
       "Effect": "Allow",
       "Resource": "*"
      },
      {
       "Action": "ssm:*",
       "Effect": "Allow",
       "Resource": "*"
      },
      {
       "Action": "textract:*",
       "Effect": "Allow",
       "Resource": "*"
      },
      {
       "Action": "s3:*",
       "Effect": "Allow",
       "Resource": "*"
      }
     ],
     "Version": "2012-10-17"
    },
    "PolicyName": "ai-asst-v2-execution-policy",
    "Roles": [
     {
      "Ref": "aiasstv2taskroleB0C2BADF"
     },
     {
      "Ref": "aiasstv2executionroleAB73BB5C"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "ai-asst-v2-ecs-stack/ai-asst-v2-execution-policy/Resource"
   }
  },
  "aiasstv2taskroleB0C2BADF": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "ecs-tasks.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "ManagedPolicyArns": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::427111452729:policy/GD-AWS-KMS-USER"
       ]
      ]
     },
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::427111452729:policy/GDDeployRoleAccessPolicy"
       ]
      ]
     },
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::427111452729:policy/AllowResourcesAccessToCloudWatchPolicy"
       ]
      ]
     }
    ],
    "PermissionsBoundary": {
     "Fn::Join": [
      "",
      [
       "arn:",
       {
        "Ref": "AWS::Partition"
       },
       ":iam::427111452729:policy/GD-AWS-SSG-PB-AI-ASSISTANT-API"
      ]
     ]
    },
    "RoleName": "commerceut-custom-ai-asst-v2-task-role",
    "Tags": [
     {
      "Key": "BudgetId",
      "Value": "001297-03"
     },
     {
      "Key": "Env",
      "Value": "dev"
     },
     {
      "Key": "LegalOU",
      "Value": "USA"
     },
     {
      "Key": "OrgOU",
      "Value": "GD"
     },
     {
      "Key": "roleType",
      "Value": "SSG-Custom"
     },
     {
      "Key": "Team",
      "Value": "commerceut"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "ai-asst-v2-ecs-stack/ai-asst-v2-task-role/Resource"
   }
  },
  "aiasstv2executionroleAB73BB5C": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "ecs-tasks.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "ManagedPolicyArns": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy"
       ]
      ]
     },
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::427111452729:policy/GD-AWS-KMS-USER"
       ]
      ]
     },
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::427111452729:policy/AllowResourcesAccessToCloudWatchPolicy"
       ]
      ]
     }
    ],
    "PermissionsBoundary": {
     "Fn::Join": [
      "",
      [
       "arn:",
       {
        "Ref": "AWS::Partition"
       },
       ":iam::427111452729:policy/GD-AWS-SSG-PB-AI-ASSISTANT-API"
      ]
     ]
    },
    "RoleName": "commerceut-custom-ai-asst-v2-execution-role",
    "Tags": [
     {
      "Key": "BudgetId",
      "Value": "001297-03"
     },
     {
      "Key": "Env",
      "Value": "dev"
     },
     {
      "Key": "LegalOU",
      "Value": "USA"
     },
     {
      "Key": "OrgOU",
      "Value": "GD"
     },
     {
      "Key": "roleType",
      "Value": "SSG-Custom"
     },
     {
      "Key": "Team",
      "Value": "commerceut"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "ai-asst-v2-ecs-stack/ai-asst-v2-execution-role/Resource"
   }
  },
  "aiasstv2executionroleDefaultPolicy67D2C547": {
   "Type": "AWS::IAM::Policy",
   "Properties": {
    "PolicyDocument": {
     "Statement": [
      {
       "Action": [
        "ecr:BatchCheckLayerAvailability",
        "ecr:GetDownloadUrlForLayer",
        "ecr:BatchGetImage"
       ],
       "Effect": "Allow",
       "Resource": {
        "Fn::ImportValue": "ai-asst-v2-ecs-ecr-stack:ExportsOutputFnGetAttaiasstv2ecrrepository90BB2C49ArnE08C10DE"
       }
      },
      {
       "Action": "ecr:GetAuthorizationToken",
       "Effect": "Allow",
       "Resource": "*"
      },
      {
       "Action": [
        "logs:CreateLogStream",
        "logs:PutLogEvents"
       ],
       "Effect": "Allow",
       "Resource": {
        "Fn::GetAtt": [
         "aiasstv2taskdefaiasstv2containerLogGroup61D9E688",
         "Arn"
        ]
       }
      },
      {
       "Action": [
        "secretsmanager:GetSecretValue",
        "secretsmanager:DescribeSecret"
       ],
       "Effect": "Allow",
       "Resource": {
        "Fn::Join": [
         "",
         [
          "arn:",
          {
           "Ref": "AWS::Partition"
          },
          ":secretsmanager:us-west-2:427111452729:secret:ai_assistant_service/certificate-??????"
         ]
        ]
       }
      },
      {
       "Action": [
        "secretsmanager:GetSecretValue",
        "secretsmanager:DescribeSecret"
       ],
       "Effect": "Allow",
       "Resource": {
        "Fn::Join": [
         "",
         [
          "arn:",
          {
           "Ref": "AWS::Partition"
          },
          ":secretsmanager:us-west-2:427111452729:secret:ai_assistant_service/key-??????"
         ]
        ]
       }
      },
      {
       "Action": [
        "secretsmanager:GetSecretValue",
        "secretsmanager:DescribeSecret"
       ],
       "Effect": "Allow",
       "Resource": {
        "Fn::Join": [
         "",
         [
          "arn:",
          {
           "Ref": "AWS::Partition"
          },
          ":secretsmanager:us-west-2:427111452729:secret:ai_assistant_service/secrets-??????"
         ]
        ]
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "PolicyName": "aiasstv2executionroleDefaultPolicy67D2C547",
    "Roles": [
     {
      "Ref": "aiasstv2executionroleAB73BB5C"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "ai-asst-v2-ecs-stack/ai-asst-v2-execution-role/DefaultPolicy/Resource"
   }
  },
  "aiasstv2securitygroupservicefromaiasstv2ecsstacksecuritygroupid3E48BB5D400049CBBC1C": {
   "Type": "AWS::EC2::SecurityGroupIngress",
   "Properties": {
    "Description": "Load balancer to target",
    "FromPort": 4000,
    "GroupId": "sg-0bc13ca920e7e2e46",
    "IpProtocol": "tcp",
    "SourceSecurityGroupId": "sg-0bc13ca920e7e2e46",
    "ToPort": 4000
   },
   "Metadata": {
    "aws:cdk:path": "ai-asst-v2-ecs-stack/ai-asst-v2-security-group-service/from aiasstv2ecsstacksecuritygroupid3E48BB5D:4000"
   }
  },
  "aiasstv2taskdef9DC08A9D": {
   "Type": "AWS::ECS::TaskDefinition",
   "Properties": {
    "ContainerDefinitions": [
     {
      "Cpu": 256,
      "Environment": [
       {
        "Name": "NODE_ENV",
        "Value": "dev"
       }
      ],
      "Essential": true,
      "Image": {
       "Fn::Join": [
        "",
        [
         {
          "Fn::Select": [
           4,
           {
            "Fn::Split": [
             ":",
             {
              "Fn::ImportValue": "ai-asst-v2-ecs-ecr-stack:ExportsOutputFnGetAttaiasstv2ecrrepository90BB2C49ArnE08C10DE"
             }
            ]
           }
          ]
         },
         ".dkr.ecr.",
         {
          "Fn::Select": [
           3,
           {
            "Fn::Split": [
             ":",
             {
              "Fn::ImportValue": "ai-asst-v2-ecs-ecr-stack:ExportsOutputFnGetAttaiasstv2ecrrepository90BB2C49ArnE08C10DE"
             }
            ]
           }
          ]
         },
         ".",
         {
          "Ref": "AWS::URLSuffix"
         },
         "/",
         {
          "Fn::ImportValue": "ai-asst-v2-ecs-ecr-stack:ExportsOutputRefaiasstv2ecrrepository90BB2C49100245EC"
         },
         ":latest"
        ]
       ]
      },
      "LogConfiguration": {
       "LogDriver": "awslogs",
       "Options": {
        "awslogs-group": {
         "Ref": "aiasstv2taskdefaiasstv2containerLogGroup61D9E688"
        },
        "awslogs-stream-prefix": "ai-asst-v2",
        "awslogs-region": "us-west-2"
       }
      },
      "Memory": 512,
      "MemoryReservation": 512,
      "Name": "ai-asst-v2-container",
      "PortMappings": [
       {
        "ContainerPort": 4000,
        "HostPort": 4000,
        "Protocol": "tcp"
       }
      ],
      "Secrets": [
       {
        "Name": "SERVER_CERT",
        "ValueFrom": {
         "Fn::Join": [
          "",
          [
           "arn:",
           {
            "Ref": "AWS::Partition"
           },
           ":secretsmanager:us-west-2:427111452729:secret:ai_assistant_service/certificate"
          ]
         ]
        }
       },
       {
        "Name": "SERVER_KEY",
        "ValueFrom": {
         "Fn::Join": [
          "",
          [
           "arn:",
           {
            "Ref": "AWS::Partition"
           },
           ":secretsmanager:us-west-2:427111452729:secret:ai_assistant_service/key"
          ]
         ]
        }
       },
       {
        "Name": "GOCAAS_API_URL",
        "ValueFrom": {
         "Fn::Join": [
          "",
          [
           "arn:",
           {
            "Ref": "AWS::Partition"
           },
           ":secretsmanager:us-west-2:427111452729:secret:ai_assistant_service/secrets:GOCAAS_API_URL::"
          ]
         ]
        }
       },
       {
        "Name": "SSO_API_ENDPOINT",
        "ValueFrom": {
         "Fn::Join": [
          "",
          [
           "arn:",
           {
            "Ref": "AWS::Partition"
           },
           ":secretsmanager:us-west-2:427111452729:secret:ai_assistant_service/secrets:SSO_API_ENDPOINT::"
          ]
         ]
        }
       },
       {
        "Name": "CERT_CRT",
        "ValueFrom": {
         "Fn::Join": [
          "",
          [
           "arn:",
           {
            "Ref": "AWS::Partition"
           },
           ":secretsmanager:us-west-2:427111452729:secret:ai_assistant_service/secrets:CERT_CRT::"
          ]
         ]
        }
       },
       {
        "Name": "CERT_KEY",
        "ValueFrom": {
         "Fn::Join": [
          "",
          [
           "arn:",
           {
            "Ref": "AWS::Partition"
           },
           ":secretsmanager:us-west-2:427111452729:secret:ai_assistant_service/secrets:CERT_KEY::"
          ]
         ]
        }
       },
       {
        "Name": "GD_API_URL",
        "ValueFrom": {
         "Fn::Join": [
          "",
          [
           "arn:",
           {
            "Ref": "AWS::Partition"
           },
           ":secretsmanager:us-west-2:427111452729:secret:ai_assistant_service/secrets:GD_API_URL::"
          ]
         ]
        }
       },
       {
        "Name": "GD_CLIENT_ID",
        "ValueFrom": {
         "Fn::Join": [
          "",
          [
           "arn:",
           {
            "Ref": "AWS::Partition"
           },
           ":secretsmanager:us-west-2:427111452729:secret:ai_assistant_service/secrets:GD_CLIENT_ID::"
          ]
         ]
        }
       },
       {
        "Name": "GD_CLIENT_SECRET",
        "ValueFrom": {
         "Fn::Join": [
          "",
          [
           "arn:",
           {
            "Ref": "AWS::Partition"
           },
           ":secretsmanager:us-west-2:427111452729:secret:ai_assistant_service/secrets:GD_CLIENT_SECRET::"
          ]
         ]
        }
       }
      ]
     }
    ],
    "Cpu": "256",
    "ExecutionRoleArn": {
     "Fn::GetAtt": [
      "aiasstv2executionroleAB73BB5C",
      "Arn"
     ]
    },
    "Family": "ai-asst-v2-task-def",
    "Memory": "512",
    "NetworkMode": "awsvpc",
    "RequiresCompatibilities": [
     "FARGATE"
    ],
    "RuntimePlatform": {
     "CpuArchitecture": "X86_64"
    },
    "Tags": [
     {
      "Key": "BudgetId",
      "Value": "001297-03"
     },
     {
      "Key": "Env",
      "Value": "dev"
     },
     {
      "Key": "LegalOU",
      "Value": "USA"
     },
     {
      "Key": "OrgOU",
      "Value": "GD"
     },
     {
      "Key": "Team",
      "Value": "commerceut"
     }
    ],
    "TaskRoleArn": {
     "Fn::GetAtt": [
      "aiasstv2taskroleB0C2BADF",
      "Arn"
     ]
    }
   },
   "Metadata": {
    "aws:cdk:path": "ai-asst-v2-ecs-stack/ai-asst-v2-task-def/Resource"
   }
  },
  "aiasstv2taskdefaiasstv2containerLogGroup61D9E688": {
   "Type": "AWS::Logs::LogGroup",
   "Properties": {
    "KmsKeyId": "arn:aws:kms:us-west-2:018549029650:alias/commerceut",
    "Tags": [
     {
      "Key": "BudgetId",
      "Value": "001297-03"
     },
     {
      "Key": "Env",
      "Value": "dev"
     },
     {
      "Key": "LegalOU",
      "Value": "USA"
     },
     {
      "Key": "OrgOU",
      "Value": "GD"
     },
     {
      "Key": "Team",
      "Value": "commerceut"
     }
    ]
   },
   "UpdateReplacePolicy": "Retain",
   "DeletionPolicy": "Retain",
   "Metadata": {
    "aws:cdk:path": "ai-asst-v2-ecs-stack/ai-asst-v2-task-def/ai-asst-v2-container/LogGroup/Resource"
   }
  },
  "aiasstv2srvcServiceA8F07AE5": {
   "Type": "AWS::ECS::Service",
   "Properties": {
    "Cluster": {
     "Ref": "aiasstv2cluster6A2E082B"
    },
    "DeploymentConfiguration": {
     "Alarms": {
      "AlarmNames": [],
      "Enable": false,
      "Rollback": false
     },
     "DeploymentCircuitBreaker": {
      "Enable": true,
      "Rollback": true
     },
     "MaximumPercent": 200,
     "MinimumHealthyPercent": 50
    },
    "DeploymentController": {
     "Type": "ECS"
    },
    "DesiredCount": 2,
    "EnableECSManagedTags": false,
    "HealthCheckGracePeriodSeconds": 5,
    "LaunchType": "FARGATE",
    "LoadBalancers": [
     {
      "ContainerName": "ai-asst-v2-container",
      "ContainerPort": 4000,
      "TargetGroupArn": {
       "Ref": "aiasstv2tg4892D37F"
      }
     }
    ],
    "NetworkConfiguration": {
     "AwsvpcConfiguration": {
      "AssignPublicIp": "DISABLED",
      "SecurityGroups": [
       "sg-0bc13ca920e7e2e46"
      ],
      "Subnets": [
       "subnet-00d6e9cd7d87ef8a7",
       "subnet-0e0b3798e079e97bb"
      ]
     }
    },
    "ServiceName": "ai-asst-v2-srvc",
    "Tags": [
     {
      "Key": "BudgetId",
      "Value": "001297-03"
     },
     {
      "Key": "Env",
      "Value": "dev"
     },
     {
      "Key": "LegalOU",
      "Value": "USA"
     },
     {
      "Key": "OrgOU",
      "Value": "GD"
     },
     {
      "Key": "Team",
      "Value": "commerceut"
     }
    ],
    "TaskDefinition": {
     "Ref": "aiasstv2taskdef9DC08A9D"
    }
   },
   "DependsOn": [
    "aiasstv2cluster6A2E082B",
    "aiasstv2loadbalanceraiasstv2listenerrule6A516B0D",
    "aiasstv2taskroleB0C2BADF"
   ],
   "Metadata": {
    "aws:cdk:path": "ai-asst-v2-ecs-stack/ai-asst-v2-srvc/Service"
   }
  },
  "aiasstv2loadbalanceraiasstv2wafD49707D1": {
   "Type": "AWS::WAFv2::WebACL",
   "Properties": {
    "DefaultAction": {
     "Allow": {}
    },
    "Name": "ai-asst-v2-web-acl",
    "Rules": [
     {
      "Name": "AWS-AWSManagedRulesCommonRuleSet",
      "OverrideAction": {
       "None": {}
      },
      "Priority": 0,
      "Statement": {
       "ManagedRuleGroupStatement": {
        "ExcludedRules": [
         {
          "Name": "SizeRestrictions_BODY"
         },
         {
          "Name": "CrossSiteScripting_BODY"
         },
         {
          "Name": "SQLi_BODY"
         }
        ],
        "Name": "AWSManagedRulesCommonRuleSet",
        "VendorName": "AWS"
       }
      },
      "VisibilityConfig": {
       "CloudWatchMetricsEnabled": true,
       "MetricName": "MetricForWebACLCDK-CRS",
       "SampledRequestsEnabled": true
      }
     },
     {
      "Name": "AWS-AWSManagedRulesSQLiRuleSet",
      "OverrideAction": {
       "None": {}
      },
      "Priority": 1,
      "Statement": {
       "ManagedRuleGroupStatement": {
        "ExcludedRules": [
         {
          "Name": "SQLi_BODY"
         }
        ],
        "Name": "AWSManagedRulesSQLiRuleSet",
        "VendorName": "AWS"
       }
      },
      "VisibilityConfig": {
       "CloudWatchMetricsEnabled": true,
       "MetricName": "MetricForWebACLCDK-CRS",
       "SampledRequestsEnabled": true
      }
     }
    ],
    "Scope": "REGIONAL",
    "Tags": [
     {
      "Key": "BudgetId",
      "Value": "001297-03"
     },
     {
      "Key": "Env",
      "Value": "dev"
     },
     {
      "Key": "LegalOU",
      "Value": "USA"
     },
     {
      "Key": "OrgOU",
      "Value": "GD"
     },
     {
      "Key": "Team",
      "Value": "commerceut"
     }
    ],
    "VisibilityConfig": {
     "CloudWatchMetricsEnabled": true,
     "MetricName": "MetricForWebACLCDK",
     "SampledRequestsEnabled": true
    }
   },
   "Metadata": {
    "aws:cdk:path": "ai-asst-v2-ecs-stack/ai-asst-v2-load-balancer/ai-asst-v2-waf"
   }
  },
  "aiasstv2loadbalanceraiasstv2listenerrule6A516B0D": {
   "Type": "AWS::ElasticLoadBalancingV2::ListenerRule",
   "Properties": {
    "Actions": [
     {
      "TargetGroupArn": {
       "Ref": "aiasstv2tg4892D37F"
      },
      "Type": "forward"
     }
    ],
    "Conditions": [
     {
      "Field": "host-header",
      "HostHeaderConfig": {
       "Values": [
        "*.test-godaddy.com",
        "*.ote-godaddy.com",
        "*.dev-godaddy.com",
        "*.godaddy.com",
        "*.secureserver.net"
       ]
      }
     }
    ],
    "ListenerArn": {
     "Ref": "aiasstv2lbhttpslistenerC6FE5F09"
    },
    "Priority": 1000
   },
   "Metadata": {
    "aws:cdk:path": "ai-asst-v2-ecs-stack/ai-asst-v2-load-balancer/ai-asst-v2-listener-rule/Resource"
   }
  },
  "aiasstv2loadbalanceraiasstv2wafassociationF8C030A2": {
   "Type": "AWS::WAFv2::WebACLAssociation",
   "Properties": {
    "ResourceArn": {
     "Ref": "aiasstv2lb32EC6AAA"
    },
    "WebACLArn": {
     "Fn::GetAtt": [
      "aiasstv2loadbalanceraiasstv2wafD49707D1",
      "Arn"
     ]
    }
   },
   "Metadata": {
    "aws:cdk:path": "ai-asst-v2-ecs-stack/ai-asst-v2-load-balancer/ai-asst-v2-waf-association"
   }
  },
  "securitygroupidtoaiasstv2ecsstackaiasstv2securitygroupservice0852EE1F4000B1C0074A": {
   "Type": "AWS::EC2::SecurityGroupEgress",
   "Properties": {
    "Description": "Load balancer to target",
    "DestinationSecurityGroupId": "sg-0bc13ca920e7e2e46",
    "FromPort": 4000,
    "GroupId": "sg-0bc13ca920e7e2e46",
    "IpProtocol": "tcp",
    "ToPort": 4000
   },
   "Metadata": {
    "aws:cdk:path": "ai-asst-v2-ecs-stack/security-group-id/to aiasstv2ecsstackaiasstv2securitygroupservice0852EE1F:4000"
   }
  },
  "aiasstv2lb32EC6AAA": {
   "Type": "AWS::ElasticLoadBalancingV2::LoadBalancer",
   "Properties": {
    "LoadBalancerAttributes": [
     {
      "Key": "deletion_protection.enabled",
      "Value": "false"
     },
     {
      "Key": "access_logs.s3.enabled",
      "Value": "true"
     },
     {
      "Key": "access_logs.s3.bucket",
      "Value": "gd-access-commerceut-dev-logs-us-west-2-mhd31curf"
     },
     {
      "Key": "access_logs.s3.prefix",
      "Value": "alb"
     }
    ],
    "Name": "ai-asst-v2-lb",
    "Scheme": "internet-facing",
    "SecurityGroups": [
     "sg-0bc13ca920e7e2e46"
    ],
    "Subnets": [
     "subnet-0814437a542e33c62",
     "subnet-0f942b25ea0577888"
    ],
    "Tags": [
     {
      "Key": "BudgetId",
      "Value": "001297-03"
     },
     {
      "Key": "Env",
      "Value": "dev"
     },
     {
      "Key": "LegalOU",
      "Value": "USA"
     },
     {
      "Key": "OrgOU",
      "Value": "GD"
     },
     {
      "Key": "Team",
      "Value": "commerceut"
     }
    ],
    "Type": "application"
   },
   "Metadata": {
    "aws:cdk:path": "ai-asst-v2-ecs-stack/ai-asst-v2-lb/Resource"
   }
  },
  "aiasstv2lbhttpslistenerC6FE5F09": {
   "Type": "AWS::ElasticLoadBalancingV2::Listener",
   "Properties": {
    "Certificates": [
     {
      "CertificateArn": {
       "Fn::Join": [
        "",
        [
         "arn:",
         {
          "Ref": "AWS::Partition"
         },
         ":acm:us-west-2:427111452729:certificate/3f772901-cfae-4eac-812a-37f6d707ac57"
        ]
       ]
      }
     }
    ],
    "DefaultActions": [
     {
      "FixedResponseConfig": {
       "ContentType": "application/json",
       "MessageBody": "Access Denied",
       "StatusCode": "403"
      },
      "Type": "fixed-response"
     }
    ],
    "LoadBalancerArn": {
     "Ref": "aiasstv2lb32EC6AAA"
    },
    "Port": 443,
    "Protocol": "HTTPS",
    "SslPolicy": "ELBSecurityPolicy-TLS-1-2-2017-01"
   },
   "Metadata": {
    "aws:cdk:path": "ai-asst-v2-ecs-stack/ai-asst-v2-lb/https-listener/Resource"
   }
  },
  "aiasstv2tg4892D37F": {
   "Type": "AWS::ElasticLoadBalancingV2::TargetGroup",
   "Properties": {
    "HealthCheckEnabled": true,
    "HealthCheckIntervalSeconds": 10,
    "HealthCheckPath": "/health",
    "HealthCheckPort": "4000",
    "HealthCheckProtocol": "HTTPS",
    "HealthCheckTimeoutSeconds": 5,
    "HealthyThresholdCount": 5,
    "Port": 4000,
    "Protocol": "HTTPS",
    "ProtocolVersion": "HTTP1",
    "Tags": [
     {
      "Key": "BudgetId",
      "Value": "001297-03"
     },
     {
      "Key": "Env",
      "Value": "dev"
     },
     {
      "Key": "LegalOU",
      "Value": "USA"
     },
     {
      "Key": "OrgOU",
      "Value": "GD"
     },
     {
      "Key": "Team",
      "Value": "commerceut"
     }
    ],
    "TargetGroupAttributes": [
     {
      "Key": "deregistration_delay.timeout_seconds",
      "Value": "30"
     },
     {
      "Key": "stickiness.enabled",
      "Value": "false"
     },
     {
      "Key": "load_balancing.algorithm.type",
      "Value": "round_robin"
     }
    ],
    "TargetType": "ip",
    "UnhealthyThresholdCount": 2,
    "VpcId": "vpc-0e3d323b001d686f5"
   },
   "Metadata": {
    "aws:cdk:path": "ai-asst-v2-ecs-stack/ai-asst-v2-tg/Resource"
   }
  },
  "objectObjectscalabletarget5722C758": {
   "Type": "AWS::ApplicationAutoScaling::ScalableTarget",
   "Properties": {
    "MaxCapacity": 10,
    "MinCapacity": 2,
    "ResourceId": "service/ai-asst-v2-cluster/ai-asst-v2-srvc",
    "RoleARN": {
     "Fn::Join": [
      "",
      [
       "arn:",
       {
        "Ref": "AWS::Partition"
       },
       ":iam::427111452729:role/aws-service-role/ecs.application-autoscaling.amazonaws.com/AWSServiceRoleForApplicationAutoScaling_ECSService"
      ]
     ]
    },
    "ScalableDimension": "ecs:service:DesiredCount",
    "ServiceNamespace": "ecs"
   },
   "Metadata": {
    "aws:cdk:path": "ai-asst-v2-ecs-stack/[object Object]-scalable-target/Resource"
   }
  },
  "aiasstv2autoscalingpolicyB01054A4": {
   "Type": "AWS::ApplicationAutoScaling::ScalingPolicy",
   "Properties": {
    "PolicyName": "ai-asst-v2-srvc-auto-scaling-policy",
    "PolicyType": "TargetTrackingScaling",
    "ScalingTargetId": {
     "Ref": "objectObjectscalabletarget5722C758"
    },
    "TargetTrackingScalingPolicyConfiguration": {
     "PredefinedMetricSpecification": {
      "PredefinedMetricType": "ECSServiceAverageCPUUtilization"
     },
     "TargetValue": 50
    }
   },
   "DependsOn": [
    "objectObjectscalabletarget5722C758"
   ],
   "Metadata": {
    "aws:cdk:path": "ai-asst-v2-ecs-stack/ai-asst-v2-auto-scaling-policy/Resource"
   }
  },
  "aiasstv2rotatorexecutionrole2AE089CB": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "lambda.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "Description": "Used by the rotator to rotate the service",
    "ManagedPolicyArns": [
     {
      "Fn::Join": [
       "",
       [
        "arn:aws:iam::",
        {
         "Ref": "AWS::AccountId"
        },
        ":policy/AllowResourcesAccessToCloudWatchPolicy"
       ]
      ]
     }
    ],
    "PermissionsBoundary": {
     "Fn::Join": [
      "",
      [
       "arn:aws:iam::",
       {
        "Ref": "AWS::AccountId"
       },
       ":policy/GD-AWS-SSG-PB-DEFAULT"
      ]
     ]
    },
    "Policies": [
     {
      "PolicyDocument": {
       "Statement": [
        {
         "Action": "ecs:UpdateService",
         "Effect": "Allow",
         "Resource": {
          "Fn::Join": [
           "",
           [
            "arn:aws:ecs:",
            {
             "Ref": "AWS::Region"
            },
            ":",
            {
             "Ref": "AWS::AccountId"
            },
            ":service/ai-asst-v2-cluster/ai-asst-v2-srvc"
           ]
          ]
         }
        }
       ],
       "Version": "2012-10-17"
      },
      "PolicyName": "root"
     }
    ],
    "RoleName": "commerceut-custom-03613ac1c7188f084e2142c68e35b4d2b3f7632e",
    "Tags": [
     {
      "Key": "BudgetId",
      "Value": "001297-03"
     },
     {
      "Key": "Env",
      "Value": "dev"
     },
     {
      "Key": "LegalOU",
      "Value": "USA"
     },
     {
      "Key": "OrgOU",
      "Value": "GD"
     },
     {
      "Key": "roleType",
      "Value": "SSG-Custom"
     },
     {
      "Key": "Team",
      "Value": "commerceut"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "ai-asst-v2-ecs-stack/ai-asst-v2-rotator-execution-role/Resource"
   }
  },
  "aiasstv2rotatorfunctionF815D079": {
   "Type": "AWS::Lambda::Function",
   "Properties": {
    "Code": {
     "S3Bucket": "godaddy-lambdas-prod-us-west-2",
     "S3Key": "ecs/ecs_service_rotator/ecs_service_rotator-2.0.0.zip"
    },
    "Handler": "ecs_service_rotator.index.handler",
    "Role": {
     "Fn::GetAtt": [
      "aiasstv2rotatorexecutionrole2AE089CB",
      "Arn"
     ]
    },
    "Runtime": "python3.9",
    "Tags": [
     {
      "Key": "BudgetId",
      "Value": "001297-03"
     },
     {
      "Key": "Env",
      "Value": "dev"
     },
     {
      "Key": "LegalOU",
      "Value": "USA"
     },
     {
      "Key": "OrgOU",
      "Value": "GD"
     },
     {
      "Key": "Team",
      "Value": "commerceut"
     }
    ],
    "Timeout": 30
   },
   "DependsOn": [
    "aiasstv2rotatorexecutionrole2AE089CB"
   ],
   "Metadata": {
    "aws:cdk:path": "ai-asst-v2-ecs-stack/ai-asst-v2-rotator-function/Resource"
   }
  },
  "aiasstv2rotatorfunctionLogRetentionD4E2A0AA": {
   "Type": "Custom::LogRetention",
   "Properties": {
    "ServiceToken": {
     "Fn::GetAtt": [
      "LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aFD4BFC8A",
      "Arn"
     ]
    },
    "LogGroupName": {
     "Fn::Join": [
      "",
      [
       "/aws/lambda/",
       {
        "Ref": "aiasstv2rotatorfunctionF815D079"
       }
      ]
     ]
    },
    "RetentionInDays": 30
   },
   "Metadata": {
    "aws:cdk:path": "ai-asst-v2-ecs-stack/ai-asst-v2-rotator-function/LogRetention/Resource"
   }
  },
  "aiasstv2rotatorfunctionInvokePermissionEF96AE6D": {
   "Type": "AWS::Lambda::Permission",
   "Properties": {
    "Action": "lambda:InvokeFunction",
    "FunctionName": {
     "Fn::GetAtt": [
      "aiasstv2rotatorfunctionF815D079",
      "Arn"
     ]
    },
    "Principal": "events.amazonaws.com",
    "SourceArn": {
     "Fn::GetAtt": [
      "aiasstv2rotatorrule7A84885C",
      "Arn"
     ]
    }
   },
   "Metadata": {
    "aws:cdk:path": "ai-asst-v2-ecs-stack/ai-asst-v2-rotator-function/InvokePermission"
   }
  },
  "LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRole9741ECFB": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "lambda.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "ManagedPolicyArns": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
       ]
      ]
     }
    ],
    "PermissionsBoundary": {
     "Fn::Join": [
      "",
      [
       "arn:aws:iam::",
       {
        "Ref": "AWS::AccountId"
       },
       ":policy/GD-AWS-SSG-PB-DEFAULT"
      ]
     ]
    },
    "RoleName": "commerceut-custom-13fa797156d54de62596077a7770d7f6c897f8cf",
    "Tags": [
     {
      "Key": "BudgetId",
      "Value": "001297-03"
     },
     {
      "Key": "Env",
      "Value": "dev"
     },
     {
      "Key": "LegalOU",
      "Value": "USA"
     },
     {
      "Key": "OrgOU",
      "Value": "GD"
     },
     {
      "Key": "roleType",
      "Value": "SSG-Custom"
     },
     {
      "Key": "Team",
      "Value": "commerceut"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "ai-asst-v2-ecs-stack/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/ServiceRole/Resource"
   }
  },
  "LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRoleDefaultPolicyADDA7DEB": {
   "Type": "AWS::IAM::Policy",
   "Properties": {
    "PolicyDocument": {
     "Statement": [
      {
       "Action": [
        "logs:PutRetentionPolicy",
        "logs:DeleteRetentionPolicy"
       ],
       "Effect": "Allow",
       "Resource": "*"
      }
     ],
     "Version": "2012-10-17"
    },
    "PolicyName": "LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRoleDefaultPolicyADDA7DEB",
    "Roles": [
     {
      "Ref": "LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRole9741ECFB"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "ai-asst-v2-ecs-stack/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/ServiceRole/DefaultPolicy/Resource"
   }
  },
  "LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aFD4BFC8A": {
   "Type": "AWS::Lambda::Function",
   "Properties": {
    "Handler": "index.handler",
    "Runtime": "nodejs18.x",
    "Code": {
     "S3Bucket": "cdk-hnb659fds-assets-427111452729-us-west-2",
     "S3Key": "5cc92ed0cea39e2b8de2dbc527dfb5980a3af9564bd1084d840b9787c7d0467e.zip"
    },
    "Role": {
     "Fn::GetAtt": [
      "LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRole9741ECFB",
      "Arn"
     ]
    },
    "Tags": [
     {
      "Key": "BudgetId",
      "Value": "001297-03"
     },
     {
      "Key": "Env",
      "Value": "dev"
     },
     {
      "Key": "LegalOU",
      "Value": "USA"
     },
     {
      "Key": "OrgOU",
      "Value": "GD"
     },
     {
      "Key": "Team",
      "Value": "commerceut"
     }
    ]
   },
   "DependsOn": [
    "LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRoleDefaultPolicyADDA7DEB",
    "LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRole9741ECFB"
   ],
   "Metadata": {
    "aws:cdk:path": "ai-asst-v2-ecs-stack/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/Resource",
    "aws:asset:path": "asset.5cc92ed0cea39e2b8de2dbc527dfb5980a3af9564bd1084d840b9787c7d0467e",
    "aws:asset:is-bundled": false,
    "aws:asset:property": "Code"
   }
  },
  "aiasstv2rotatorrule7A84885C": {
   "Type": "AWS::Events::Rule",
   "Properties": {
    "Description": "Rotates the service",
    "ScheduleExpression": "cron(0 0 * * ? *)",
    "State": "ENABLED",
    "Targets": [
     {
      "Arn": {
       "Fn::GetAtt": [
        "aiasstv2rotatorfunctionF815D079",
        "Arn"
       ]
      },
      "Id": "Target0",
      "Input": "{\"cluster\":\"ai-asst-v2-cluster\",\"service\":\"ai-asst-v2-srvc\"}"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "ai-asst-v2-ecs-stack/ai-asst-v2-rotator-rule/Resource"
   }
  },
  "aiasstv2rotatorruleAllowEventRuleaiasstv2ecsstackaiasstv2rotatorfunctionDC6501EE6F0AFD04": {
   "Type": "AWS::Lambda::Permission",
   "Properties": {
    "Action": "lambda:InvokeFunction",
    "FunctionName": {
     "Fn::GetAtt": [
      "aiasstv2rotatorfunctionF815D079",
      "Arn"
     ]
    },
    "Principal": "events.amazonaws.com",
    "SourceArn": {
     "Fn::GetAtt": [
      "aiasstv2rotatorrule7A84885C",
      "Arn"
     ]
    }
   },
   "Metadata": {
    "aws:cdk:path": "ai-asst-v2-ecs-stack/ai-asst-v2-rotator-rule/AllowEventRuleaiasstv2ecsstackaiasstv2rotatorfunctionDC6501EE"
   }
  },
  "aiasstv2alarmsaiasstv2memorywarningalarm8125A891": {
   "Type": "AWS::CloudWatch::Alarm",
   "Properties": {
    "ActionsEnabled": true,
    "AlarmActions": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":sns:us-west-2:427111452729:sns-commerceut-dev"
       ]
      ]
     }
    ],
    "AlarmDescription": "Fires when ai-asst-v2-srvc is using a high percentage of Memory",
    "AlarmName": "ai-asst-v2-srvc-Memory-Warning test ai-asst-v2-cluster",
    "ComparisonOperator": "GreaterThanThreshold",
    "DatapointsToAlarm": 6,
    "EvaluationPeriods": 10,
    "Metrics": [
     {
      "Expression": "100 * (memoryUtilized / memoryReserved)",
      "Id": "expr_1"
     },
     {
      "Id": "memoryUtilized",
      "MetricStat": {
       "Metric": {
        "Dimensions": [
         {
          "Name": "ClusterName",
          "Value": "ai-asst-v2-cluster"
         },
         {
          "Name": "ServiceName",
          "Value": "ai-asst-v2-srvc"
         }
        ],
        "MetricName": "MemoryUtilized",
        "Namespace": "ECS/ContainerInsights"
       },
       "Period": 300,
       "Stat": "Sum"
      },
      "ReturnData": false
     },
     {
      "Id": "memoryReserved",
      "MetricStat": {
       "Metric": {
        "Dimensions": [
         {
          "Name": "ClusterName",
          "Value": "ai-asst-v2-cluster"
         },
         {
          "Name": "ServiceName",
          "Value": "ai-asst-v2-srvc"
         }
        ],
        "MetricName": "MemoryReserved",
        "Namespace": "ECS/ContainerInsights"
       },
       "Period": 300,
       "Stat": "Sum"
      },
      "ReturnData": false
     }
    ],
    "OKActions": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":sns:us-west-2:427111452729:sns-commerceut-dev"
       ]
      ]
     }
    ],
    "Threshold": 80
   },
   "Metadata": {
    "aws:cdk:path": "ai-asst-v2-ecs-stack/ai-asst-v2-alarms/ai-asst-v2-memory-warning-alarm/Resource"
   }
  },
  "aiasstv2alarmsaiasstv2memorycriticalalarm202D4C47": {
   "Type": "AWS::CloudWatch::Alarm",
   "Properties": {
    "ActionsEnabled": true,
    "AlarmActions": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":sns:us-west-2:427111452729:sns-commerceut-dev"
       ]
      ]
     }
    ],
    "AlarmDescription": "Fires when ai-asst-v2-srvc is using a high percentage of Memory",
    "AlarmName": "ai-asst-v2-srvc-Memory-Critical test ai-asst-v2-cluster",
    "ComparisonOperator": "GreaterThanThreshold",
    "DatapointsToAlarm": 6,
    "EvaluationPeriods": 10,
    "Metrics": [
     {
      "Expression": "100 * (memoryUtilized / memoryReserved)",
      "Id": "expr_1"
     },
     {
      "Id": "memoryUtilized",
      "MetricStat": {
       "Metric": {
        "Dimensions": [
         {
          "Name": "ClusterName",
          "Value": "ai-asst-v2-cluster"
         },
         {
          "Name": "ServiceName",
          "Value": "ai-asst-v2-srvc"
         }
        ],
        "MetricName": "MemoryUtilized",
        "Namespace": "ECS/ContainerInsights"
       },
       "Period": 300,
       "Stat": "Sum"
      },
      "ReturnData": false
     },
     {
      "Id": "memoryReserved",
      "MetricStat": {
       "Metric": {
        "Dimensions": [
         {
          "Name": "ClusterName",
          "Value": "ai-asst-v2-cluster"
         },
         {
          "Name": "ServiceName",
          "Value": "ai-asst-v2-srvc"
         }
        ],
        "MetricName": "MemoryReserved",
        "Namespace": "ECS/ContainerInsights"
       },
       "Period": 300,
       "Stat": "Sum"
      },
      "ReturnData": false
     }
    ],
    "OKActions": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":sns:us-west-2:427111452729:sns-commerceut-dev"
       ]
      ]
     }
    ],
    "Threshold": 90
   },
   "Metadata": {
    "aws:cdk:path": "ai-asst-v2-ecs-stack/ai-asst-v2-alarms/ai-asst-v2-memory-critical-alarm/Resource"
   }
  },
  "aiasstv2alarmsaiasstv2cpuwarningalarm4F51BBDD": {
   "Type": "AWS::CloudWatch::Alarm",
   "Properties": {
    "ActionsEnabled": true,
    "AlarmActions": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":sns:us-west-2:427111452729:sns-commerceut-dev"
       ]
      ]
     }
    ],
    "AlarmDescription": "Fires when ai-asst-v2-srvc is using a high percentage of CPU",
    "AlarmName": "ai-asst-v2-srvc-CPU-Warning test ai-asst-v2-cluster",
    "ComparisonOperator": "GreaterThanThreshold",
    "DatapointsToAlarm": 6,
    "EvaluationPeriods": 10,
    "Metrics": [
     {
      "Expression": "100 * (cpuUtilized / cpuReserved)",
      "Id": "expr_1"
     },
     {
      "Id": "cpuUtilized",
      "MetricStat": {
       "Metric": {
        "Dimensions": [
         {
          "Name": "ClusterName",
          "Value": "ai-asst-v2-cluster"
         },
         {
          "Name": "ServiceName",
          "Value": "ai-asst-v2-srvc"
         }
        ],
        "MetricName": "CpuUtilized",
        "Namespace": "ECS/ContainerInsights"
       },
       "Period": 300,
       "Stat": "Sum"
      },
      "ReturnData": false
     },
     {
      "Id": "cpuReserved",
      "MetricStat": {
       "Metric": {
        "Dimensions": [
         {
          "Name": "ClusterName",
          "Value": "ai-asst-v2-cluster"
         },
         {
          "Name": "ServiceName",
          "Value": "ai-asst-v2-srvc"
         }
        ],
        "MetricName": "CpuReserved",
        "Namespace": "ECS/ContainerInsights"
       },
       "Period": 300,
       "Stat": "Sum"
      },
      "ReturnData": false
     }
    ],
    "OKActions": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":sns:us-west-2:427111452729:sns-commerceut-dev"
       ]
      ]
     }
    ],
    "Threshold": 80
   },
   "Metadata": {
    "aws:cdk:path": "ai-asst-v2-ecs-stack/ai-asst-v2-alarms/ai-asst-v2-cpu-warning-alarm/Resource"
   }
  },
  "aiasstv2alarmsaiasstv2cpucriticalalarm57959E49": {
   "Type": "AWS::CloudWatch::Alarm",
   "Properties": {
    "ActionsEnabled": true,
    "AlarmActions": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":sns:us-west-2:427111452729:sns-commerceut-dev"
       ]
      ]
     }
    ],
    "AlarmDescription": "Fires when ai-asst-v2-srvc is using a high percentage of CPU",
    "AlarmName": "ai-asst-v2-srvc-CPU-Critical test ai-asst-v2-cluster",
    "ComparisonOperator": "GreaterThanThreshold",
    "DatapointsToAlarm": 6,
    "EvaluationPeriods": 10,
    "Metrics": [
     {
      "Expression": "100 * (cpuUtilized / cpuReserved)",
      "Id": "expr_1"
     },
     {
      "Id": "cpuUtilized",
      "MetricStat": {
       "Metric": {
        "Dimensions": [
         {
          "Name": "ClusterName",
          "Value": "ai-asst-v2-cluster"
         },
         {
          "Name": "ServiceName",
          "Value": "ai-asst-v2-srvc"
         }
        ],
        "MetricName": "CpuUtilized",
        "Namespace": "ECS/ContainerInsights"
       },
       "Period": 300,
       "Stat": "Sum"
      },
      "ReturnData": false
     },
     {
      "Id": "cpuReserved",
      "MetricStat": {
       "Metric": {
        "Dimensions": [
         {
          "Name": "ClusterName",
          "Value": "ai-asst-v2-cluster"
         },
         {
          "Name": "ServiceName",
          "Value": "ai-asst-v2-srvc"
         }
        ],
        "MetricName": "CpuReserved",
        "Namespace": "ECS/ContainerInsights"
       },
       "Period": 300,
       "Stat": "Sum"
      },
      "ReturnData": false
     }
    ],
    "OKActions": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":sns:us-west-2:427111452729:sns-commerceut-dev"
       ]
      ]
     }
    ],
    "Threshold": 90
   },
   "Metadata": {
    "aws:cdk:path": "ai-asst-v2-ecs-stack/ai-asst-v2-alarms/ai-asst-v2-cpu-critical-alarm/Resource"
   }
  },
  "aiasstv2alarmsaiasstv2taskcountcriticalalarmB606F63B": {
   "Type": "AWS::CloudWatch::Alarm",
   "Properties": {
    "ActionsEnabled": true,
    "AlarmActions": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":sns:us-west-2:427111452729:sns-commerceut-dev"
       ]
      ]
     }
    ],
    "AlarmDescription": "Fires when ai-asst-v2-srvc is running higher number of tasks",
    "AlarmName": "ai-asst-v2-srvc-TaskCount-Critical test ai-asst-v2-cluster",
    "ComparisonOperator": "GreaterThanThreshold",
    "DatapointsToAlarm": 6,
    "Dimensions": [
     {
      "Name": "ClusterName",
      "Value": "ai-asst-v2-cluster"
     },
     {
      "Name": "ServiceName",
      "Value": "ai-asst-v2-srvc"
     }
    ],
    "EvaluationPeriods": 10,
    "MetricName": "RunningTaskCount",
    "Namespace": "ECS/ContainerInsights",
    "OKActions": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":sns:us-west-2:427111452729:sns-commerceut-dev"
       ]
      ]
     }
    ],
    "Period": 60,
    "Statistic": "Maximum",
    "Threshold": 1,
    "Unit": "Count"
   },
   "Metadata": {
    "aws:cdk:path": "ai-asst-v2-ecs-stack/ai-asst-v2-alarms/ai-asst-v2-task-count-critical-alarm/Resource"
   }
  },
  "aiasstv2alarmsaiasstv2unhealthytargetalarm17373CD3": {
   "Type": "AWS::CloudWatch::Alarm",
   "Properties": {
    "ActionsEnabled": true,
    "AlarmActions": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":sns:us-west-2:427111452729:sns-commerceut-dev"
       ]
      ]
     }
    ],
    "AlarmDescription": "Fires when ai-asst-v2-srvc has 1 or more unhealthy targets",
    "AlarmName": "ai-asst-v2-srvc-UnhealthyTarget-Alarm test ai-asst-v2-cluster",
    "ComparisonOperator": "GreaterThanOrEqualToThreshold",
    "DatapointsToAlarm": 6,
    "Dimensions": [
     {
      "Name": "LoadBalancer",
      "Value": {
       "Fn::GetAtt": [
        "aiasstv2lb32EC6AAA",
        "LoadBalancerFullName"
       ]
      }
     },
     {
      "Name": "TargetGroup",
      "Value": {
       "Fn::GetAtt": [
        "aiasstv2tg4892D37F",
        "TargetGroupFullName"
       ]
      }
     }
    ],
    "EvaluationPeriods": 10,
    "MetricName": "UnHealthyHostCount",
    "Namespace": "AWS/ApplicationELB",
    "OKActions": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":sns:us-west-2:427111452729:sns-commerceut-dev"
       ]
      ]
     }
    ],
    "Period": 60,
    "Statistic": "Maximum",
    "Threshold": 1,
    "Unit": "Count"
   },
   "Metadata": {
    "aws:cdk:path": "ai-asst-v2-ecs-stack/ai-asst-v2-alarms/ai-asst-v2-unhealthy-target-alarm/Resource"
   }
  },
  "aiasstv2alarmsaiasstv2targetconnectionerroralarmFED99B73": {
   "Type": "AWS::CloudWatch::Alarm",
   "Properties": {
    "ActionsEnabled": true,
    "AlarmActions": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":sns:us-west-2:427111452729:sns-commerceut-dev"
       ]
      ]
     }
    ],
    "AlarmDescription": "Fires when ai-asst-v2-srvc ELB is unable to connect to targets",
    "AlarmName": "ai-asst-v2-srvc-TargetConnectionError-Alarm test ai-asst-v2-cluster",
    "ComparisonOperator": "GreaterThanOrEqualToThreshold",
    "DatapointsToAlarm": 6,
    "Dimensions": [
     {
      "Name": "LoadBalancer",
      "Value": {
       "Fn::GetAtt": [
        "aiasstv2lb32EC6AAA",
        "LoadBalancerFullName"
       ]
      }
     },
     {
      "Name": "TargetGroup",
      "Value": {
       "Fn::GetAtt": [
        "aiasstv2tg4892D37F",
        "TargetGroupFullName"
       ]
      }
     }
    ],
    "EvaluationPeriods": 10,
    "MetricName": "TargetConnectionErrorCount",
    "Namespace": "AWS/ApplicationELB",
    "OKActions": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":sns:us-west-2:427111452729:sns-commerceut-dev"
       ]
      ]
     }
    ],
    "Period": 60,
    "Statistic": "Sum",
    "Threshold": 10,
    "TreatMissingData": "ignore",
    "Unit": "Count"
   },
   "Metadata": {
    "aws:cdk:path": "ai-asst-v2-ecs-stack/ai-asst-v2-alarms/ai-asst-v2-target-connection-error-alarm/Resource"
   }
  },
  "aiasstv2alarmsobjectObjectfivehundrederroralarm1D77DA5B": {
   "Type": "AWS::CloudWatch::Alarm",
   "Properties": {
    "ActionsEnabled": true,
    "AlarmActions": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":sns:us-west-2:427111452729:sns-commerceut-dev"
       ]
      ]
     }
    ],
    "AlarmDescription": "Fires when ai-asst-v2-srvc has 5XX",
    "AlarmName": "ai-asst-v2-srvc-5XX-Alarm test ai-asst-v2-cluster",
    "ComparisonOperator": "GreaterThanOrEqualToThreshold",
    "DatapointsToAlarm": 6,
    "Dimensions": [
     {
      "Name": "LoadBalancer",
      "Value": {
       "Fn::GetAtt": [
        "aiasstv2lb32EC6AAA",
        "LoadBalancerFullName"
       ]
      }
     },
     {
      "Name": "TargetGroup",
      "Value": {
       "Fn::GetAtt": [
        "aiasstv2tg4892D37F",
        "TargetGroupFullName"
       ]
      }
     }
    ],
    "EvaluationPeriods": 10,
    "MetricName": "HTTPCode_Target_5XX_Count",
    "Namespace": "AWS/ApplicationELB",
    "OKActions": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":sns:us-west-2:427111452729:sns-commerceut-dev"
       ]
      ]
     }
    ],
    "Period": 60,
    "Statistic": "Sum",
    "Threshold": 10,
    "TreatMissingData": "ignore",
    "Unit": "Count"
   },
   "Metadata": {
    "aws:cdk:path": "ai-asst-v2-ecs-stack/ai-asst-v2-alarms/[object Object]-five-hundred-error-alarm/Resource"
   }
  },
  "aiasstv2alarmsaiasstv2responsetimeerroralarm3D0488C5": {
   "Type": "AWS::CloudWatch::Alarm",
   "Properties": {
    "ActionsEnabled": true,
    "AlarmActions": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":sns:us-west-2:427111452729:sns-commerceut-dev"
       ]
      ]
     }
    ],
    "AlarmDescription": "Fires when ai-asst-v2-srvc has high response time",
    "AlarmName": "ai-asst-v2-srvc-ResponseTime-Alarm test ai-asst-v2-cluster",
    "ComparisonOperator": "GreaterThanOrEqualToThreshold",
    "DatapointsToAlarm": 6,
    "Dimensions": [
     {
      "Name": "LoadBalancer",
      "Value": {
       "Fn::GetAtt": [
        "aiasstv2lb32EC6AAA",
        "LoadBalancerFullName"
       ]
      }
     },
     {
      "Name": "TargetGroup",
      "Value": {
       "Fn::GetAtt": [
        "aiasstv2tg4892D37F",
        "TargetGroupFullName"
       ]
      }
     }
    ],
    "EvaluationPeriods": 10,
    "ExtendedStatistic": "p95",
    "MetricName": "TargetResponseTime",
    "Namespace": "AWS/ApplicationELB",
    "OKActions": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":sns:us-west-2:427111452729:sns-commerceut-dev"
       ]
      ]
     }
    ],
    "Period": 60,
    "Threshold": 5,
    "TreatMissingData": "ignore",
    "Unit": "Seconds"
   },
   "Metadata": {
    "aws:cdk:path": "ai-asst-v2-ecs-stack/ai-asst-v2-alarms/ai-asst-v2-response-time-error-alarm/Resource"
   }
  },
  "CDKMetadata": {
   "Type": "AWS::CDK::Metadata",
   "Properties": {
    "Analytics": "v2:deflate64:H4sIAAAAAAAA/21SwW7qMBD8lt6N21Lp6fUItH16EocqIPVYbZwlNTg28tqgKvK/d+0ADVVPO57MTtbjncrHqby7gSNNVLObGF3LvkJy0SsUzL73qEj2CxMpoBeLjT3DF/AtBFwD7Z5wo60O2tks+Mk4G0Bb9CPu1LtCf9D8H246wSQ0dLJ/dUarz8yfUOVMkeWaBKopj5SbVPQ6fP7zLu7/29YjkfjJPxc6CeNavsjStYXNsgtmUGFAm2dL4gibw+D/hvVssRQXNCNySsMgQwMUtDIOmhoMWKVtm/tm+z2PXERLzUnxzas4TH91HuvYY148hoivzr/4jb3G39ccK4bL/UbHJOBbBjE4UmB4YNmvGEBtcBCX9K6Zoaw9qB03rIa+7we6IpKgBzmPaodhDoTCQFc3IPuXaNV5Pcb4FX2niUqe9PAORBhIznIReOAH4Rc7h5crqyzJtdtrVfw5/dgcIagPzt2A77KwgJRKz3mTi+UqQMujJmFdg3JLt4f7v/L+D6//lrSe+MgL0KGshvoFtCUGfBoDAAA="
   },
   "Metadata": {
    "aws:cdk:path": "ai-asst-v2-ecs-stack/CDKMetadata/Default"
   }
  }
 }
}