{
 "Resources": {
  "catalogapidemocluster50E6F681": {
   "Type": "AWS::ECS::Cluster",
   "Properties": {
    "ClusterName": "catalog-api-demo-cluster",
    "Tags": [
     {
      "Key": "BudgetId",
      "Value": "001297-02"
     },
     {
      "Key": "doNotShutdown",
      "Value": "false"
     },
     {
      "Key": "Env",
      "Value": "dev-private"
     },
     {
      "Key": "LegalOU",
      "Value": "USA"
     },
     {
      "Key": "OrgOU",
      "Value": "GD"
     },
     {
      "Key": "Team",
      "Value": "commerceut"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "catalog-api-demo-ecs-stack/catalog-api-demo-cluster/Resource"
   }
  },
  "catalogapidemoexecutionpolicy7E2E24D9": {
   "Type": "AWS::IAM::Policy",
   "Properties": {
    "PolicyDocument": {
     "Statement": [
      {
       "Action": [
        "ecr:GetAuthorizationToken",
        "ecr:BatchGetImage",
        "ecr:GetDownloadUrlForLayer"
       ],
       "Effect": "Allow",
       "Resource": "*"
      },
      {
       "Action": "logs:*",
       "Effect": "Allow",
       "Resource": "*"
      },
      {
       "Action": "ssm:*",
       "Effect": "Allow",
       "Resource": "*"
      },
      {
       "Action": "textract:*",
       "Effect": "Allow",
       "Resource": "*"
      },
      {
       "Action": "s3:*",
       "Effect": "Allow",
       "Resource": "*"
      }
     ],
     "Version": "2012-10-17"
    },
    "PolicyName": "catalog-api-demo-execution-policy",
    "Roles": [
     {
      "Ref": "catalogapidemotaskrole1452C413"
     },
     {
      "Ref": "catalogapidemoexecutionroleE636AA05"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "catalog-api-demo-ecs-stack/catalog-api-demo-execution-policy/Resource"
   }
  },
  "catalogapidemotaskrole1452C413": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "ecs-tasks.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "ManagedPolicyArns": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::166610760322:policy/GD-AWS-KMS-USER"
       ]
      ]
     },
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::166610760322:policy/GDDeployRoleAccessPolicy"
       ]
      ]
     },
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::166610760322:policy/AllowResourcesAccessToCloudWatchPolicy"
       ]
      ]
     }
    ],
    "PermissionsBoundary": {
     "Fn::Join": [
      "",
      [
       "arn:aws:iam::",
       {
        "Ref": "AWS::AccountId"
       },
       ":policy/GD-AWS-SSG-PB-DEFAULT"
      ]
     ]
    },
    "RoleName": "commerceut-custom-catalog-api-demo-task-role",
    "Tags": [
     {
      "Key": "BudgetId",
      "Value": "001297-02"
     },
     {
      "Key": "doNotShutdown",
      "Value": "false"
     },
     {
      "Key": "Env",
      "Value": "dev-private"
     },
     {
      "Key": "LegalOU",
      "Value": "USA"
     },
     {
      "Key": "OrgOU",
      "Value": "GD"
     },
     {
      "Key": "roleType",
      "Value": "SSG-Custom"
     },
     {
      "Key": "Team",
      "Value": "commerceut"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "catalog-api-demo-ecs-stack/catalog-api-demo-task-role/Resource"
   }
  },
  "catalogapidemoexecutionroleE636AA05": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "ecs-tasks.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "ManagedPolicyArns": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy"
       ]
      ]
     },
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::166610760322:policy/GD-AWS-KMS-USER"
       ]
      ]
     },
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::166610760322:policy/AllowResourcesAccessToCloudWatchPolicy"
       ]
      ]
     }
    ],
    "PermissionsBoundary": {
     "Fn::Join": [
      "",
      [
       "arn:aws:iam::",
       {
        "Ref": "AWS::AccountId"
       },
       ":policy/GD-AWS-SSG-PB-DEFAULT"
      ]
     ]
    },
    "RoleName": "commerceut-custom-catalog-api-demo-execution-role",
    "Tags": [
     {
      "Key": "BudgetId",
      "Value": "001297-02"
     },
     {
      "Key": "doNotShutdown",
      "Value": "false"
     },
     {
      "Key": "Env",
      "Value": "dev-private"
     },
     {
      "Key": "LegalOU",
      "Value": "USA"
     },
     {
      "Key": "OrgOU",
      "Value": "GD"
     },
     {
      "Key": "roleType",
      "Value": "SSG-Custom"
     },
     {
      "Key": "Team",
      "Value": "commerceut"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "catalog-api-demo-ecs-stack/catalog-api-demo-execution-role/Resource"
   }
  },
  "catalogapidemoexecutionroleDefaultPolicyCBEF4969": {
   "Type": "AWS::IAM::Policy",
   "Properties": {
    "PolicyDocument": {
     "Statement": [
      {
       "Action": [
        "ecr:BatchCheckLayerAvailability",
        "ecr:GetDownloadUrlForLayer",
        "ecr:BatchGetImage"
       ],
       "Effect": "Allow",
       "Resource": {
        "Fn::ImportValue": "catalog-api-demo-ecs-ecr-stack:ExportsOutputFnGetAttcatalogapidemoecrrepository425CAAD9Arn92BC2F34"
       }
      },
      {
       "Action": "ecr:GetAuthorizationToken",
       "Effect": "Allow",
       "Resource": "*"
      },
      {
       "Action": [
        "logs:CreateLogStream",
        "logs:PutLogEvents"
       ],
       "Effect": "Allow",
       "Resource": {
        "Fn::GetAtt": [
         "catalogapidemotaskdefcatalogapidemocontainerLogGroup2476E96E",
         "Arn"
        ]
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "PolicyName": "catalogapidemoexecutionroleDefaultPolicyCBEF4969",
    "Roles": [
     {
      "Ref": "catalogapidemoexecutionroleE636AA05"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "catalog-api-demo-ecs-stack/catalog-api-demo-execution-role/DefaultPolicy/Resource"
   }
  },
  "catalogapidemosecuritygroupservicefromcatalogapidemoecsstacksecuritygroupidA90F18CB400034382FB8": {
   "Type": "AWS::EC2::SecurityGroupIngress",
   "Properties": {
    "Description": "Load balancer to target",
    "FromPort": 4000,
    "GroupId": "sg-0e9f341372bf73d78",
    "IpProtocol": "tcp",
    "SourceSecurityGroupId": "sg-0e9f341372bf73d78",
    "ToPort": 4000
   },
   "Metadata": {
    "aws:cdk:path": "catalog-api-demo-ecs-stack/catalog-api-demo-security-group-service/from catalogapidemoecsstacksecuritygroupidA90F18CB:4000"
   }
  },
  "catalogapidemotaskdefCB248AFB": {
   "Type": "AWS::ECS::TaskDefinition",
   "Properties": {
    "ContainerDefinitions": [
     {
      "Cpu": 256,
      "Environment": [
       {
        "Name": "NODE_ENV",
        "Value": "dev-private"
       }
      ],
      "Essential": true,
      "Image": {
       "Fn::Join": [
        "",
        [
         {
          "Fn::Select": [
           4,
           {
            "Fn::Split": [
             ":",
             {
              "Fn::ImportValue": "catalog-api-demo-ecs-ecr-stack:ExportsOutputFnGetAttcatalogapidemoecrrepository425CAAD9Arn92BC2F34"
             }
            ]
           }
          ]
         },
         ".dkr.ecr.",
         {
          "Fn::Select": [
           3,
           {
            "Fn::Split": [
             ":",
             {
              "Fn::ImportValue": "catalog-api-demo-ecs-ecr-stack:ExportsOutputFnGetAttcatalogapidemoecrrepository425CAAD9Arn92BC2F34"
             }
            ]
           }
          ]
         },
         ".",
         {
          "Ref": "AWS::URLSuffix"
         },
         "/",
         {
          "Fn::ImportValue": "catalog-api-demo-ecs-ecr-stack:ExportsOutputRefcatalogapidemoecrrepository425CAAD9A6F1B4F6"
         },
         ":latest"
        ]
       ]
      },
      "LogConfiguration": {
       "LogDriver": "awslogs",
       "Options": {
        "awslogs-group": {
         "Ref": "catalogapidemotaskdefcatalogapidemocontainerLogGroup2476E96E"
        },
        "awslogs-stream-prefix": "catalog-api-demo",
        "awslogs-region": "us-west-2"
       }
      },
      "Memory": 512,
      "MemoryReservation": 512,
      "Name": "catalog-api-demo-container",
      "PortMappings": [
       {
        "ContainerPort": 4000,
        "HostPort": 4000,
        "Protocol": "tcp"
       }
      ]
     }
    ],
    "Cpu": "256",
    "ExecutionRoleArn": {
     "Fn::GetAtt": [
      "catalogapidemoexecutionroleE636AA05",
      "Arn"
     ]
    },
    "Family": "catalog-api-demo-task-def",
    "Memory": "512",
    "NetworkMode": "awsvpc",
    "RequiresCompatibilities": [
     "FARGATE"
    ],
    "RuntimePlatform": {
     "CpuArchitecture": "X86_64"
    },
    "Tags": [
     {
      "Key": "BudgetId",
      "Value": "001297-02"
     },
     {
      "Key": "doNotShutdown",
      "Value": "false"
     },
     {
      "Key": "Env",
      "Value": "dev-private"
     },
     {
      "Key": "LegalOU",
      "Value": "USA"
     },
     {
      "Key": "OrgOU",
      "Value": "GD"
     },
     {
      "Key": "Team",
      "Value": "commerceut"
     }
    ],
    "TaskRoleArn": {
     "Fn::GetAtt": [
      "catalogapidemotaskrole1452C413",
      "Arn"
     ]
    }
   },
   "Metadata": {
    "aws:cdk:path": "catalog-api-demo-ecs-stack/catalog-api-demo-task-def/Resource"
   }
  },
  "catalogapidemotaskdefcatalogapidemocontainerLogGroup2476E96E": {
   "Type": "AWS::Logs::LogGroup",
   "Properties": {
    "KmsKeyId": "arn:aws:kms:us-west-2:669979021785:alias/commerceut",
    "Tags": [
     {
      "Key": "BudgetId",
      "Value": "001297-02"
     },
     {
      "Key": "doNotShutdown",
      "Value": "false"
     },
     {
      "Key": "Env",
      "Value": "dev-private"
     },
     {
      "Key": "LegalOU",
      "Value": "USA"
     },
     {
      "Key": "OrgOU",
      "Value": "GD"
     },
     {
      "Key": "Team",
      "Value": "commerceut"
     }
    ]
   },
   "UpdateReplacePolicy": "Retain",
   "DeletionPolicy": "Retain",
   "Metadata": {
    "aws:cdk:path": "catalog-api-demo-ecs-stack/catalog-api-demo-task-def/catalog-api-demo-container/LogGroup/Resource"
   }
  },
  "catalogapidemosrvcService27A65060": {
   "Type": "AWS::ECS::Service",
   "Properties": {
    "Cluster": {
     "Ref": "catalogapidemocluster50E6F681"
    },
    "DeploymentConfiguration": {
     "Alarms": {
      "AlarmNames": [],
      "Enable": false,
      "Rollback": false
     },
     "DeploymentCircuitBreaker": {
      "Enable": true,
      "Rollback": true
     },
     "MaximumPercent": 200,
     "MinimumHealthyPercent": 50
    },
    "DeploymentController": {
     "Type": "ECS"
    },
    "DesiredCount": 2,
    "EnableECSManagedTags": false,
    "HealthCheckGracePeriodSeconds": 60,
    "LaunchType": "FARGATE",
    "LoadBalancers": [
     {
      "ContainerName": "catalog-api-demo-container",
      "ContainerPort": 4000,
      "TargetGroupArn": {
       "Ref": "catalogapidemotgDAB2AC5F"
      }
     }
    ],
    "NetworkConfiguration": {
     "AwsvpcConfiguration": {
      "AssignPublicIp": "DISABLED",
      "SecurityGroups": [
       "sg-0e9f341372bf73d78"
      ],
      "Subnets": [
       "subnet-023521a11c0d4c7b5",
       "subnet-0d0c69aeac2e701ef"
      ]
     }
    },
    "ServiceName": "catalog-api-demo-srvc",
    "Tags": [
     {
      "Key": "BudgetId",
      "Value": "001297-02"
     },
     {
      "Key": "doNotShutdown",
      "Value": "false"
     },
     {
      "Key": "Env",
      "Value": "dev-private"
     },
     {
      "Key": "LegalOU",
      "Value": "USA"
     },
     {
      "Key": "OrgOU",
      "Value": "GD"
     },
     {
      "Key": "Team",
      "Value": "commerceut"
     }
    ],
    "TaskDefinition": {
     "Ref": "catalogapidemotaskdefCB248AFB"
    }
   },
   "DependsOn": [
    "catalogapidemocluster50E6F681",
    "catalogapidemoloadbalancercatalogapidemolistenerrule77D37F6C",
    "catalogapidemotaskrole1452C413"
   ],
   "Metadata": {
    "aws:cdk:path": "catalog-api-demo-ecs-stack/catalog-api-demo-srvc/Service"
   }
  },
  "catalogapidemoloadbalancercatalogapidemowaf034909FA": {
   "Type": "AWS::WAFv2::WebACL",
   "Properties": {
    "DefaultAction": {
     "Allow": {}
    },
    "Name": "catalog-api-demo-web-acl",
    "Rules": [
     {
      "Name": "AWS-AWSManagedRulesCommonRuleSet",
      "OverrideAction": {
       "None": {}
      },
      "Priority": 0,
      "Statement": {
       "ManagedRuleGroupStatement": {
        "ExcludedRules": [
         {
          "Name": "SizeRestrictions_BODY"
         },
         {
          "Name": "CrossSiteScripting_BODY"
         },
         {
          "Name": "SQLi_BODY"
         }
        ],
        "Name": "AWSManagedRulesCommonRuleSet",
        "VendorName": "AWS"
       }
      },
      "VisibilityConfig": {
       "CloudWatchMetricsEnabled": true,
       "MetricName": "MetricForWebACLCDK-CRS",
       "SampledRequestsEnabled": true
      }
     },
     {
      "Name": "AWS-AWSManagedRulesSQLiRuleSet",
      "OverrideAction": {
       "None": {}
      },
      "Priority": 1,
      "Statement": {
       "ManagedRuleGroupStatement": {
        "ExcludedRules": [
         {
          "Name": "SQLi_BODY"
         }
        ],
        "Name": "AWSManagedRulesSQLiRuleSet",
        "VendorName": "AWS"
       }
      },
      "VisibilityConfig": {
       "CloudWatchMetricsEnabled": true,
       "MetricName": "MetricForWebACLCDK-CRS",
       "SampledRequestsEnabled": true
      }
     }
    ],
    "Scope": "REGIONAL",
    "Tags": [
     {
      "Key": "BudgetId",
      "Value": "001297-02"
     },
     {
      "Key": "doNotShutdown",
      "Value": "false"
     },
     {
      "Key": "Env",
      "Value": "dev-private"
     },
     {
      "Key": "LegalOU",
      "Value": "USA"
     },
     {
      "Key": "OrgOU",
      "Value": "GD"
     },
     {
      "Key": "Team",
      "Value": "commerceut"
     }
    ],
    "VisibilityConfig": {
     "CloudWatchMetricsEnabled": true,
     "MetricName": "MetricForWebACLCDK",
     "SampledRequestsEnabled": true
    }
   },
   "Metadata": {
    "aws:cdk:path": "catalog-api-demo-ecs-stack/catalog-api-demo-load-balancer/catalog-api-demo-waf"
   }
  },
  "catalogapidemoloadbalancercatalogapidemolistenerrule77D37F6C": {
   "Type": "AWS::ElasticLoadBalancingV2::ListenerRule",
   "Properties": {
    "Actions": [
     {
      "TargetGroupArn": {
       "Ref": "catalogapidemotgDAB2AC5F"
      },
      "Type": "forward"
     }
    ],
    "Conditions": [
     {
      "Field": "host-header",
      "HostHeaderConfig": {
       "Values": [
        "*.test-godaddy.com",
        "*.ote-godaddy.com",
        "*.dev-godaddy.com",
        "*.godaddy.com",
        "*.secureserver.net"
       ]
      }
     }
    ],
    "ListenerArn": {
     "Ref": "catalogapidemolbhttpslistenerB1C47E35"
    },
    "Priority": 1000
   },
   "Metadata": {
    "aws:cdk:path": "catalog-api-demo-ecs-stack/catalog-api-demo-load-balancer/catalog-api-demo-listener-rule/Resource"
   }
  },
  "catalogapidemoloadbalancercatalogapidemowafassociationEB63A407": {
   "Type": "AWS::WAFv2::WebACLAssociation",
   "Properties": {
    "ResourceArn": {
     "Ref": "catalogapidemolb5A8C39F1"
    },
    "WebACLArn": {
     "Fn::GetAtt": [
      "catalogapidemoloadbalancercatalogapidemowaf034909FA",
      "Arn"
     ]
    }
   },
   "Metadata": {
    "aws:cdk:path": "catalog-api-demo-ecs-stack/catalog-api-demo-load-balancer/catalog-api-demo-waf-association"
   }
  },
  "securitygroupidtocatalogapidemoecsstackcatalogapidemosecuritygroupservice45F8CE064000BF3DFF3E": {
   "Type": "AWS::EC2::SecurityGroupEgress",
   "Properties": {
    "Description": "Load balancer to target",
    "DestinationSecurityGroupId": "sg-0e9f341372bf73d78",
    "FromPort": 4000,
    "GroupId": "sg-0e9f341372bf73d78",
    "IpProtocol": "tcp",
    "ToPort": 4000
   },
   "Metadata": {
    "aws:cdk:path": "catalog-api-demo-ecs-stack/security-group-id/to catalogapidemoecsstackcatalogapidemosecuritygroupservice45F8CE06:4000"
   }
  },
  "catalogapidemolb5A8C39F1": {
   "Type": "AWS::ElasticLoadBalancingV2::LoadBalancer",
   "Properties": {
    "LoadBalancerAttributes": [
     {
      "Key": "deletion_protection.enabled",
      "Value": "false"
     },
     {
      "Key": "access_logs.s3.enabled",
      "Value": "true"
     },
     {
      "Key": "access_logs.s3.bucket",
      "Value": "gd-access-commerceut-dev-private-logs-us-west-2-7zmf5le2r"
     },
     {
      "Key": "access_logs.s3.prefix",
      "Value": "alb"
     }
    ],
    "Name": "catalog-api-demo-lb",
    "Scheme": "internet-facing",
    "SecurityGroups": [
     "sg-0e9f341372bf73d78"
    ],
    "Subnets": [
     "subnet-0325792d023ba95a1",
     "subnet-08ce7e1938d5a8016"
    ],
    "Tags": [
     {
      "Key": "BudgetId",
      "Value": "001297-02"
     },
     {
      "Key": "doNotShutdown",
      "Value": "false"
     },
     {
      "Key": "Env",
      "Value": "dev-private"
     },
     {
      "Key": "LegalOU",
      "Value": "USA"
     },
     {
      "Key": "OrgOU",
      "Value": "GD"
     },
     {
      "Key": "Team",
      "Value": "commerceut"
     }
    ],
    "Type": "application"
   },
   "Metadata": {
    "aws:cdk:path": "catalog-api-demo-ecs-stack/catalog-api-demo-lb/Resource"
   }
  },
  "catalogapidemolbhttpslistenerB1C47E35": {
   "Type": "AWS::ElasticLoadBalancingV2::Listener",
   "Properties": {
    "Certificates": [
     {
      "CertificateArn": "arn:aws:acm:us-west-2:166610760322:certificate/cf37fa20-8629-485b-9174-d1d9e1e939e3"
     }
    ],
    "DefaultActions": [
     {
      "FixedResponseConfig": {
       "ContentType": "application/json",
       "MessageBody": "Access Denied",
       "StatusCode": "403"
      },
      "Type": "fixed-response"
     }
    ],
    "LoadBalancerArn": {
     "Ref": "catalogapidemolb5A8C39F1"
    },
    "Port": 443,
    "Protocol": "HTTPS",
    "SslPolicy": "ELBSecurityPolicy-TLS-1-2-2017-01"
   },
   "Metadata": {
    "aws:cdk:path": "catalog-api-demo-ecs-stack/catalog-api-demo-lb/https-listener/Resource"
   }
  },
  "catalogapidemotgDAB2AC5F": {
   "Type": "AWS::ElasticLoadBalancingV2::TargetGroup",
   "Properties": {
    "HealthCheckEnabled": false,
    "HealthCheckIntervalSeconds": 10,
    "HealthCheckPath": "/health",
    "HealthCheckPort": "4000",
    "HealthCheckProtocol": "HTTPS",
    "HealthCheckTimeoutSeconds": 5,
    "HealthyThresholdCount": 5,
    "Port": 4000,
    "Protocol": "HTTPS",
    "ProtocolVersion": "HTTP1",
    "Tags": [
     {
      "Key": "BudgetId",
      "Value": "001297-02"
     },
     {
      "Key": "doNotShutdown",
      "Value": "false"
     },
     {
      "Key": "Env",
      "Value": "dev-private"
     },
     {
      "Key": "LegalOU",
      "Value": "USA"
     },
     {
      "Key": "OrgOU",
      "Value": "GD"
     },
     {
      "Key": "Team",
      "Value": "commerceut"
     }
    ],
    "TargetGroupAttributes": [
     {
      "Key": "deregistration_delay.timeout_seconds",
      "Value": "30"
     },
     {
      "Key": "stickiness.enabled",
      "Value": "false"
     },
     {
      "Key": "load_balancing.algorithm.type",
      "Value": "round_robin"
     }
    ],
    "TargetType": "ip",
    "UnhealthyThresholdCount": 2,
    "VpcId": "vpc-004057ec24194ccf7"
   },
   "Metadata": {
    "aws:cdk:path": "catalog-api-demo-ecs-stack/catalog-api-demo-tg/Resource"
   }
  },
  "objectObjectscalabletarget5722C758": {
   "Type": "AWS::ApplicationAutoScaling::ScalableTarget",
   "Properties": {
    "MaxCapacity": 10,
    "MinCapacity": 2,
    "ResourceId": "service/catalog-api-demo-cluster/catalog-api-demo-srvc",
    "RoleARN": {
     "Fn::Join": [
      "",
      [
       "arn:",
       {
        "Ref": "AWS::Partition"
       },
       ":iam::166610760322:role/aws-service-role/ecs.application-autoscaling.amazonaws.com/AWSServiceRoleForApplicationAutoScaling_ECSService"
      ]
     ]
    },
    "ScalableDimension": "ecs:service:DesiredCount",
    "ServiceNamespace": "ecs"
   },
   "Metadata": {
    "aws:cdk:path": "catalog-api-demo-ecs-stack/[object Object]-scalable-target/Resource"
   }
  },
  "catalogapidemoautoscalingpolicyA16005A1": {
   "Type": "AWS::ApplicationAutoScaling::ScalingPolicy",
   "Properties": {
    "PolicyName": "catalog-api-demo-srvc-auto-scaling-policy",
    "PolicyType": "TargetTrackingScaling",
    "ScalingTargetId": {
     "Ref": "objectObjectscalabletarget5722C758"
    },
    "TargetTrackingScalingPolicyConfiguration": {
     "PredefinedMetricSpecification": {
      "PredefinedMetricType": "ECSServiceAverageCPUUtilization"
     },
     "TargetValue": 50
    }
   },
   "DependsOn": [
    "objectObjectscalabletarget5722C758"
   ],
   "Metadata": {
    "aws:cdk:path": "catalog-api-demo-ecs-stack/catalog-api-demo-auto-scaling-policy/Resource"
   }
  },
  "catalogapidemorotatorexecutionroleB41619B4": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "lambda.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "Description": "Used by the rotator to rotate the service",
    "ManagedPolicyArns": [
     {
      "Fn::Join": [
       "",
       [
        "arn:aws:iam::",
        {
         "Ref": "AWS::AccountId"
        },
        ":policy/AllowResourcesAccessToCloudWatchPolicy"
       ]
      ]
     }
    ],
    "PermissionsBoundary": {
     "Fn::Join": [
      "",
      [
       "arn:aws:iam::",
       {
        "Ref": "AWS::AccountId"
       },
       ":policy/GD-AWS-SSG-PB-DEFAULT"
      ]
     ]
    },
    "Policies": [
     {
      "PolicyDocument": {
       "Statement": [
        {
         "Action": "ecs:UpdateService",
         "Effect": "Allow",
         "Resource": {
          "Fn::Join": [
           "",
           [
            "arn:aws:ecs:",
            {
             "Ref": "AWS::Region"
            },
            ":",
            {
             "Ref": "AWS::AccountId"
            },
            ":service/catalog-api-demo-cluster/catalog-api-demo-srvc"
           ]
          ]
         }
        }
       ],
       "Version": "2012-10-17"
      },
      "PolicyName": "root"
     }
    ],
    "RoleName": "commerceut-custom-40938de82355f711ebfc280fd710b37c80847920",
    "Tags": [
     {
      "Key": "BudgetId",
      "Value": "001297-02"
     },
     {
      "Key": "doNotShutdown",
      "Value": "false"
     },
     {
      "Key": "Env",
      "Value": "dev-private"
     },
     {
      "Key": "LegalOU",
      "Value": "USA"
     },
     {
      "Key": "OrgOU",
      "Value": "GD"
     },
     {
      "Key": "roleType",
      "Value": "SSG-Custom"
     },
     {
      "Key": "Team",
      "Value": "commerceut"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "catalog-api-demo-ecs-stack/catalog-api-demo-rotator-execution-role/Resource"
   }
  },
  "catalogapidemorotatorfunction666ADD03": {
   "Type": "AWS::Lambda::Function",
   "Properties": {
    "Code": {
     "S3Bucket": "godaddy-lambdas-prod-us-west-2",
     "S3Key": "ecs/ecs_service_rotator/ecs_service_rotator-2.0.0.zip"
    },
    "Handler": "ecs_service_rotator.index.handler",
    "Role": {
     "Fn::GetAtt": [
      "catalogapidemorotatorexecutionroleB41619B4",
      "Arn"
     ]
    },
    "Runtime": "python3.9",
    "Tags": [
     {
      "Key": "BudgetId",
      "Value": "001297-02"
     },
     {
      "Key": "doNotShutdown",
      "Value": "false"
     },
     {
      "Key": "Env",
      "Value": "dev-private"
     },
     {
      "Key": "LegalOU",
      "Value": "USA"
     },
     {
      "Key": "OrgOU",
      "Value": "GD"
     },
     {
      "Key": "Team",
      "Value": "commerceut"
     }
    ],
    "Timeout": 30
   },
   "DependsOn": [
    "catalogapidemorotatorexecutionroleB41619B4"
   ],
   "Metadata": {
    "aws:cdk:path": "catalog-api-demo-ecs-stack/catalog-api-demo-rotator-function/Resource"
   }
  },
  "catalogapidemorotatorfunctionLogRetentionFB0AF505": {
   "Type": "Custom::LogRetention",
   "Properties": {
    "ServiceToken": {
     "Fn::GetAtt": [
      "LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aFD4BFC8A",
      "Arn"
     ]
    },
    "LogGroupName": {
     "Fn::Join": [
      "",
      [
       "/aws/lambda/",
       {
        "Ref": "catalogapidemorotatorfunction666ADD03"
       }
      ]
     ]
    },
    "RetentionInDays": 30
   },
   "Metadata": {
    "aws:cdk:path": "catalog-api-demo-ecs-stack/catalog-api-demo-rotator-function/LogRetention/Resource"
   }
  },
  "catalogapidemorotatorfunctionInvokePermissionFEE301E1": {
   "Type": "AWS::Lambda::Permission",
   "Properties": {
    "Action": "lambda:InvokeFunction",
    "FunctionName": {
     "Fn::GetAtt": [
      "catalogapidemorotatorfunction666ADD03",
      "Arn"
     ]
    },
    "Principal": "events.amazonaws.com",
    "SourceArn": {
     "Fn::GetAtt": [
      "catalogapidemorotatorrule3C5BE4BF",
      "Arn"
     ]
    }
   },
   "Metadata": {
    "aws:cdk:path": "catalog-api-demo-ecs-stack/catalog-api-demo-rotator-function/InvokePermission"
   }
  },
  "LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRole9741ECFB": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "lambda.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "ManagedPolicyArns": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
       ]
      ]
     }
    ],
    "PermissionsBoundary": {
     "Fn::Join": [
      "",
      [
       "arn:aws:iam::",
       {
        "Ref": "AWS::AccountId"
       },
       ":policy/GD-AWS-SSG-PB-DEFAULT"
      ]
     ]
    },
    "RoleName": "commerceut-custom-493fc0bbc0c9c25988def4fe1ea998206d5d12c2",
    "Tags": [
     {
      "Key": "BudgetId",
      "Value": "001297-02"
     },
     {
      "Key": "doNotShutdown",
      "Value": "false"
     },
     {
      "Key": "Env",
      "Value": "dev-private"
     },
     {
      "Key": "LegalOU",
      "Value": "USA"
     },
     {
      "Key": "OrgOU",
      "Value": "GD"
     },
     {
      "Key": "roleType",
      "Value": "SSG-Custom"
     },
     {
      "Key": "Team",
      "Value": "commerceut"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "catalog-api-demo-ecs-stack/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/ServiceRole/Resource"
   }
  },
  "LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRoleDefaultPolicyADDA7DEB": {
   "Type": "AWS::IAM::Policy",
   "Properties": {
    "PolicyDocument": {
     "Statement": [
      {
       "Action": [
        "logs:PutRetentionPolicy",
        "logs:DeleteRetentionPolicy"
       ],
       "Effect": "Allow",
       "Resource": "*"
      }
     ],
     "Version": "2012-10-17"
    },
    "PolicyName": "LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRoleDefaultPolicyADDA7DEB",
    "Roles": [
     {
      "Ref": "LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRole9741ECFB"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "catalog-api-demo-ecs-stack/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/ServiceRole/DefaultPolicy/Resource"
   }
  },
  "LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aFD4BFC8A": {
   "Type": "AWS::Lambda::Function",
   "Properties": {
    "Handler": "index.handler",
    "Runtime": "nodejs18.x",
    "Code": {
     "S3Bucket": "cdk-hnb659fds-assets-166610760322-us-west-2",
     "S3Key": "5cc92ed0cea39e2b8de2dbc527dfb5980a3af9564bd1084d840b9787c7d0467e.zip"
    },
    "Role": {
     "Fn::GetAtt": [
      "LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRole9741ECFB",
      "Arn"
     ]
    },
    "Tags": [
     {
      "Key": "BudgetId",
      "Value": "001297-02"
     },
     {
      "Key": "doNotShutdown",
      "Value": "false"
     },
     {
      "Key": "Env",
      "Value": "dev-private"
     },
     {
      "Key": "LegalOU",
      "Value": "USA"
     },
     {
      "Key": "OrgOU",
      "Value": "GD"
     },
     {
      "Key": "Team",
      "Value": "commerceut"
     }
    ]
   },
   "DependsOn": [
    "LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRoleDefaultPolicyADDA7DEB",
    "LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRole9741ECFB"
   ],
   "Metadata": {
    "aws:cdk:path": "catalog-api-demo-ecs-stack/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/Resource",
    "aws:asset:path": "asset.5cc92ed0cea39e2b8de2dbc527dfb5980a3af9564bd1084d840b9787c7d0467e",
    "aws:asset:is-bundled": false,
    "aws:asset:property": "Code"
   }
  },
  "catalogapidemorotatorrule3C5BE4BF": {
   "Type": "AWS::Events::Rule",
   "Properties": {
    "Description": "Rotates the service",
    "ScheduleExpression": "cron(0 0 * * ? *)",
    "State": "ENABLED",
    "Targets": [
     {
      "Arn": {
       "Fn::GetAtt": [
        "catalogapidemorotatorfunction666ADD03",
        "Arn"
       ]
      },
      "Id": "Target0",
      "Input": "{\"cluster\":\"catalog-api-demo-cluster\",\"service\":\"catalog-api-demo-srvc\"}"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "catalog-api-demo-ecs-stack/catalog-api-demo-rotator-rule/Resource"
   }
  },
  "catalogapidemorotatorruleAllowEventRulecatalogapidemoecsstackcatalogapidemorotatorfunction22A410128247211C": {
   "Type": "AWS::Lambda::Permission",
   "Properties": {
    "Action": "lambda:InvokeFunction",
    "FunctionName": {
     "Fn::GetAtt": [
      "catalogapidemorotatorfunction666ADD03",
      "Arn"
     ]
    },
    "Principal": "events.amazonaws.com",
    "SourceArn": {
     "Fn::GetAtt": [
      "catalogapidemorotatorrule3C5BE4BF",
      "Arn"
     ]
    }
   },
   "Metadata": {
    "aws:cdk:path": "catalog-api-demo-ecs-stack/catalog-api-demo-rotator-rule/AllowEventRulecatalogapidemoecsstackcatalogapidemorotatorfunction22A41012"
   }
  },
  "CDKMetadata": {
   "Type": "AWS::CDK::Metadata",
   "Properties": {
    "Analytics": "v2:deflate64:H4sIAAAAAAAA/21Sy24CMQz8lt5D2lKpao9AH6rEoVqQekTeYFaBkKA4oUKr/HudLI8F9eTJ7Nhrjz2Ur0P5cAe/NFDLzcDoWrYVkoteoWB20aIi2U5MpIBeTFb2BD/ANxBwDrR5w5W2Omhns+CWcTaAtuh73DF3hn6v+T+cdIRJaNjK9tsZrQ6ZP6LKmSLLMQlUQ24pJ6nodTh8ehd3X7bxSCRu+fdCJ2Fcw4NMXVPYLDtjBhUGtLm3JH5hte/q/2A9mkzFGY2InNLQydAABa2Mg2UNBqzStsl5o92OWy6iqWanePIqdt1fvfs6rjEuNTqLr97/1OvX6n+fs60YzvP1nknARQYxOFJguGHZzhhAbbATF/eumS7MPagNJ8y6vMuCrogk6EmOo9pgGAOhMLCtlyDbj2jV6Tz6+Bv9VhMVP+lpAUQYSI5yELjnhfDGTublmFJBp/sswlmAhhtIwrolyjXd7x9f5OMzH/WatB74yGvdoqy6+AdoSJQ38AIAAA=="
   },
   "Metadata": {
    "aws:cdk:path": "catalog-api-demo-ecs-stack/CDKMetadata/Default"
   }
  }
 }
}